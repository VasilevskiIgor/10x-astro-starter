---
/**
 * Reset Password Page
 *
 * New password setup page (accessed via email link).
 * Features:
 * - Token validation from URL
 * - New password form
 * - Redirect to login after success
 */

import Layout from "@/layouts/Layout.astro";
import { ResetPasswordForm } from "@/components/forms/ResetPasswordForm";

// NOTE: Supabase sends tokens in URL hash (#access_token=xxx&type=recovery)
// Hash parameters are NOT available server-side in Astro, only client-side
// So we ALWAYS show the form and let the React component extract the token from hash
const url = new URL(Astro.request.url);
const token = url.searchParams.get("token") || url.searchParams.get("access_token") || null;
---

<Layout title="Ustaw nowe hasło - Magic Travel App">
  <main
    class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-blue-50 flex items-center justify-center px-4 py-12 sm:px-6 lg:px-8"
  >
    <div class="w-full max-w-md">
      {/* Header */}
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Ustaw nowe hasło</h1>
        <p class="mt-2 text-sm text-gray-600">Wprowadź nowe hasło do swojego konta</p>
      </div>

      {/* Reset Password Form Card */}
      <div class="bg-white rounded-lg shadow-xl p-8 border border-gray-200">
        <ResetPasswordForm client:only="react" accessToken={token} />
      </div>
    </div>
  </main>
</Layout>
